# slashing - 惩罚模块

验证者惩罚机制

对于每一个验证器中，我们都会保留一份`ValidatorSigningInfo`记录，其中包含与验证器的活跃度和其他违规相关属性相关的信息。



犯了什么事情？如果进行惩罚？如何知道验证器犯了什么事情？



### 违规时间线

为了说明 x/slashing 模块如何通过 Tendermint 共识处理提交的证据，请考虑以下示例：

定义：

[  :  开始时间

]  :  结束时间

Cn:  违规 n 被提交

Dn:  违规 n  被发现

Vb:  验证器绑定奖励

Vu: 验证器解绑奖励

- 单双签违规

<-----------------> [----------C1----D1,Vu-----]

- 多双签违规

<---------------------------> [----------C1--C2---C3---D1,D2,D3Vu-----]



### 疑问： 双签是什么？



### Unjail

如果验证者由于停机而自动解除绑定并希望重新上线并可能重新加入验证列表。那么需要发送 unjail 信息。



如果验证人拥有足够的权益(第一名)，他会立刻重新绑定。所有的奖励都开始计算。



### 活跃度追踪，识别验证器是否违规或者停机

在每一个块开始之前，我们为每一个验证器更新 `ValidatorSigningInfo`信息，检查他们是否在活动窗口上超过活跃度阈值。这个滑动窗口SignedBlocksWindow 定义，这个窗口的索引是由 `IndexOffset` 决定。

对于每一个处理的区块，无论验证者是否签名，IndexOffset 都会递增。

一旦确定了索引，MissedBlocksBitArray 和 MissedBlocksCounter 就会相应地更新。



为了确定验证者是否低于活跃度阈值，

我们计算最大丢失区块： maxMissed = SignedBlocksWindow() - MinSignedPerWindow()

minHeight 最低高度。



目前区块高度  >  minHeight  && MissedBlocksCounter > maxMissed 

=> SlashFractionDowntime, jaild  for DowntimeJailDuration, 